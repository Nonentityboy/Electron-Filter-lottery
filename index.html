<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>排列五号码过滤工具</title>
</head>
<style>
  .container {
    height: 420px;
    width: 700px;
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    padding: 25px;
    margin-bottom: 0;
  }

  .menu {
    height: 425px;
    width: 340px;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    border: 1px solid #dddddd;
  }

  .header {
    width: 300px;
    height: 50px;
    margin: 10px 0;
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    border: 1px solid #dddddd;
    padding: 10px 0;
  }

  .header div {
    margin: 0 3px;
  }

  button {
    width: 80px;
    /* 宽度 */
    height: 40px;
    /* 高度 */
    border-width: 0px;
    /* 边框宽度 */
    border-radius: 3px;
    /* 边框半径 */
    background: #CC0000;
    /* 背景颜色 */
    cursor: pointer;
    /* 鼠标移入按钮范围时出现手势 */
    outline: none;
    /* 不显示轮廓线 */
    font-family: Microsoft YaHei;
    /* 设置字体 */
    color: white;
    /* 字体颜色 */
    font-size: 12px;
  }

  .body .body-header {
    display: flex;
    flex-direction: row;
    width: 300px;
    margin: 10px 0;
    justify-content: space-around;
    align-items: center;
    background: #EEBCAB;
    border: 1px solid #dddddd;
  }

  .footer {
    display: flex;
    flex-direction: row;
    width: 300px;
    justify-content: space-between;
  }

  .circle {
    font-size: 14px;
    height: 26px;
    width: 26px;
    border-radius: 13px 13px;
    display: flex;
    box-sizing: border-box;
  }

  .circle span {
    line-height: 30px;
    color: #fff;
    height: 30px;
    text-align: center;
    width: 30px;
  }
</style>

<body>
  <div style="border: 1px solid #ddd;">
    <div class="container">
      <div class="menu">
        <div class="header">
          <div>比对位数</div>
          <div id="Contrast1" class="circle" style="background-color: #CC0000;"><span>一</span></div>
          <div id="Contrast2" class="circle" style="background-color: #CC0000;"><span>二</span></div>
          <div id="Contrast3" class="circle" style="background-color: #CC0000;"><span>三</span></div>
          <div id="Contrast4" class="circle" style="background-color: #CC0000;"><span>四</span></div>
          <div id="Contrast5" class="circle" style="background-color: #CC0000;"><span>五</span></div>
        </div>
        <div class="body">
          <div class="body-header">
            <div>001</div>
            <div>002</div>
            <div>003</div>
          </div>
          <div id="pailie3"
            style="width:300px;height: 230px;border:1px solid #ddd;overflow:yes; overflow-y:scroll; overflow-y:yes;">
            请将排列三文件拖拽至此处</div>
        </div>
        <div class="footer">
          <input type="file" id="btn_file" style="display:none">
          <button onclick="F_Open_dialog3()">导入排列三</button>
          <button onclick="F_Empty_dialog3()">清空</button>
        </div>
      </div>
      <div class="menu">
        <div class="header" style="justify-content: space-between;">
          <div>排列五</div>
          <button onclick="F_Open_dialog5()">导入排列五</button>
        </div>
        <div class="body">
          <div class="body-header">
            <div>001</div>
            <div>002</div>
            <div>003</div>
            <div>004</div>
            <div>005</div>
          </div>
          <div id="pailie5"
            style="width:300px;height:230px;border:1px solid #ddd;overflow:yes; overflow-y:scroll; overflow-y:yes;overflow-x:no;">
            请将排列五文件拖拽至此处</div>
        </div>
        <div class="footer">
          <button onclick="Executive()">执行过滤</button>
          <button onclick="F_Empty_dialog5()">清空</button>
          <button onclick="setUp()">导出</button>
        </div>
      </div>
    </div>
    <div style="display: flex;flex-direction: row;align-items: center;">
      <img src="logo.jpg" alt="Powered_Wizz" style="
      width: 30px;
      height: 30px;margin-left:25px;
  ">
      <div style="color:#999999;">由为之工作室提供技术支持</div>
    </div>
  </div>


  <script type="text/javascript">
    let haveFile3 = false;
    let haveFile5 = false;
    let numFile3 = [];
    let numFile5 = [];
    let startNum;
    var endNum = [];
    let pathFile5 = '';
    //导入文件左
    var fs = require('fs');
    var pailie3 = document.getElementById('pailie3');
    pailie3.ondragover = function () {
      return false;
    };
    pailie3.ondragleave = pailie3.ondragend = function () {
      return false;
    };
    pailie3.ondrop = function (e) {
      e.preventDefault();
      var file = e.dataTransfer.files[0];
      fs.readFile(file.path, 'utf8', function (err, data) {
        pailie3.textContent = data;
        var b = data.split(" ").filter(function (s) {
          return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
        })
        endNum = [];
        c = b.map(Number);
        numFile3 = c;
        haveFile3 = true;
      });
      return false;
    };
    // 清空按钮左
    function F_Empty_dialog3() {
      pailie3.textContent = '请将排列三文件拖拽至此处';
      haveFile3 = false;
      endNum = [];
    }
    // 清空按钮右
    function F_Empty_dialog5() {
      pailie5.textContent = '请将排列五文件拖拽至此处';
      haveFile5 = false;
      endNum = [];
    }
    //导入文件右
    var fs = require('fs');
    var pailie5 = document.getElementById('pailie5');
    pailie5.ondragover = function () {
      return false;
    };
    pailie5.ondragleave = pailie5.ondragend = function () {
      return false;
    };
    pailie5.ondrop = function (e) {
      e.preventDefault();
      var file = e.dataTransfer.files[0];
      console.log(file)
      pathFile5 = e.dataTransfer.files[0];
      fs.readFile(file.path, 'utf8', function (err, data) {
        console.log(data)
        pailie5.textContent = data;
        let b;
        if (data.indexOf(" ") == -1) {
          b = data.split(",").filter(function (s) {
            return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
          });
        } else {
          b = data.split(" ").filter(function (s) {
            return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
          });
        }
        // let b = data.split(" ").filter(function (s) {
        //   return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
        // });
        // let b = data.split(",").filter(function (s) {
        //   return s && s.trim(); // 注：IE9(不包含IE9)以下的版本没有trim()方法
        // });
        endNum = [];
        c = b.map(Number);
        numFile5 = c;
        haveFile5 = true;
      });
      return false;
    };
    // 左边排列三内容
    function F_Open_dialog3(event) {
      document.getElementById("btn_file").click();
      setTimeout(function () {
        console.log(document.getElementById('btn_file').files[0].path);
        fs.readFile(document.getElementById('btn_file').files[0].path, 'utf8', function (err, data) {
          pailie3.textContent = data;
          haveFile3 = true;
        });
        alert("导入成功!");
      }, 5000);
    }
    // 右边排列五内容
    function F_Open_dialog5(event) {
      document.getElementById("btn_file").click();
      setTimeout(function () {
        console.log(document.getElementById('btn_file').files[0].path);
        fs.readFile(document.getElementById('btn_file').files[0].path, 'utf8', function (err, data) {
          pailie5.textContent = data;
          haveFile5 = true;
        });
        alert("导入成功!");
      }, 5000);
    }
    //导出功能
    function setUp() {
      var os = require('os');
      var path = os.homedir();
      var fs = require('fs');
      fs.writeFile(path + "/test.txt", endNum, function (err) {
        if (err) {
          return console.log(err);
        }
        alert(`文件改写并导出成功！`)
      });

      //        var os = require('os');
      //                           var path = os.homedir();
      //         var createFolder = function(to) { //文件写入
      //             var sep = path.sep
      //             var folders = path.dirname(to).split(sep);
      //             var p = '';
      //             while (folders.length) {
      //                 p += folders.shift() + sep;
      //                 if (!fs.existsSync(p)) {
      //                     fs.mkdirSync(p);
      //                 }
      //             }
      //         }
      //         createFolder('/publis/out.txt');
      // fs.createWriteStream('public/out.txt')


      // var os = require('os');
      // var homedir = os.homedir();
      // var fs = require('fs');
      // fs.link("/test.txt", endNum, function (err) {
      //   if (err) {
      //     return console.log(err);
      //   }
      //   console.log("The file was saved!");
      // });
      // fs.writeFile(pathFile5.path, endNum, function (err) {
      //   if (!err) {
      //     alert(`${pathFile5.name}文件改写并导出成功！`)
      //   }
      // })
      // console.log(endNum)
    }
    //执行过滤功能
    function Executive() {
      if (!(haveFile3 && haveFile5 && pailieNum === 3)) {
        alert("请检查文件是否导入及比对位数是否选中三位!")
      }
      else {
        // var a = parseInt(num % 10); // 个位数
        // var b = parseInt((num % 100) / 10); // 十位数
        // var c = parseInt((num % 1000) / 100); // 百位数
        // var d = parseInt((num % 10000) / 1000); // 千位数
        // var e = parseInt((num % 100000) / 10000); // 万位数
        console.log(numFile3);
        console.log(numFile5);
        console.log(`文件导入成功！`);
        // 123 124 125 134   135 145 234  235 245 345
        if (document.getElementById("Contrast1").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast2").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast3").style.backgroundColor === "rgb(0, 0, 0)") {
          ///123
          for (var i = 0; i < numFile3.length; i++) {
            for (var j = 0; j < numFile5.length; j++) {
              if (numFile3[i] === parseInt(parseInt((numFile5[j] % 100000) / 10000) * 100
                + parseInt((numFile5[j] % 10000) / 1000) * 10
                + parseInt((numFile5[j] % 1000) / 100))) {

                endNum.push(buquan(numFile5[j], 5));
              }
            }
          }
        }
        else if (document.getElementById("Contrast1").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast2").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast4").style.backgroundColor === "rgb(0, 0, 0)") {
          //124
          for (var i = 0; i < numFile3.length; i++) {
            for (var j = 0; j < numFile5.length; j++) {
              if (numFile3[i] === parseInt((numFile5[j] % 100000) / 10000) * 100 +
                parseInt((numFile5[j] % 10000) / 1000) * 10 +
                parseInt((numFile5[j] % 100) / 10)) {
                endNum.push(buquan(numFile5[j], 5));
              }
            }
          }
        }
        else if (document.getElementById("Contrast1").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast2").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast5").style.backgroundColor === "rgb(0, 0, 0)") {
          //125
          for (var i = 0; i < numFile3.length; i++) {
            for (var j = 0; j < numFile5.length; j++) {
              if (numFile3[i] === parseInt((numFile5[j] % 100000) / 10000) * 100 +
                parseInt((numFile5[j] % 10000) / 1000) * 10 +
                parseInt(numFile5[j] % 10)) {
                endNum.push(buquan(numFile5[j], 5));
              }
            }
          }
        }
        else if (document.getElementById("Contrast1").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast3").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast4").style.backgroundColor === "rgb(0, 0, 0)") {
          //134
          for (var i = 0; i < numFile3.length; i++) {
            for (var j = 0; j < numFile5.length; j++) {
              if (numFile3[i] === parseInt((numFile5[j] % 100000) / 10000) * 100 +
                parseInt((numFile5[j] % 1000) / 100) * 10 +
                parseInt((numFile5[j] % 100) / 10)) {
                endNum.push(buquan(numFile5[j], 5));
              }
            }
          }
        }
        else if (document.getElementById("Contrast1").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast3").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast5").style.backgroundColor === "rgb(0, 0, 0)") {
          //135
          for (var i = 0; i < numFile3.length; i++) {
            for (var j = 0; j < numFile5.length; j++) {
              if (numFile3[i] === parseInt((numFile5[j] % 100000) / 10000) * 100 +
                parseInt((numFile5[j] % 1000) / 100) * 10 +
                parseInt(numFile5[j] % 10)) {
                endNum.push(buquan(numFile5[j], 5));
              }
            }
          }
        }
        else if (document.getElementById("Contrast1").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast4").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast5").style.backgroundColor === "rgb(0, 0, 0)") {
          //145
          for (var i = 0; i < numFile3.length; i++) {
            for (var j = 0; j < numFile5.length; j++) {
              if (numFile3[i] === parseInt((numFile5[j] % 100000) / 10000) * 100 +
                parseInt((numFile5[j] % 100) / 10) * 10 +
                parseInt(numFile5[j] % 10)) {
                endNum.push(buquan(numFile5[j], 5));
              }
            }
          }
        }
        else if (document.getElementById("Contrast2").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast3").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast4").style.backgroundColor === "rgb(0, 0, 0)") {
          //234
          for (var i = 0; i < numFile3.length; i++) {
            for (var j = 0; j < numFile5.length; j++) {
              if (numFile3[i] === parseInt((numFile5[j] % 10000) / 1000) * 100 +
                parseInt((numFile5[j] % 1000) / 100) * 10 +
                parseInt((numFile5[j] % 100) / 10)) {
                endNum.push(buquan(numFile5[j], 5));
              }
            }
          }
        }
        else if (document.getElementById("Contrast2").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast4").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast5").style.backgroundColor === "rgb(0, 0, 0)") {
          //245
          for (var i = 0; i < numFile3.length; i++) {
            for (var j = 0; j < numFile5.length; j++) {
              if (numFile3[i] === parseInt((numFile5[j] % 10000) / 1000) * 100 +
                parseInt((numFile5[j] % 100) / 10) * 10 +
                parseInt(numFile5[j] % 10)) {
                endNum.push(buquan(numFile5[j], 5));
              }
            }
          }
        }
        else if (document.getElementById("Contrast2").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast3").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast5").style.backgroundColor === "rgb(0, 0, 0)") {
          //235
          for (var i = 0; i < numFile3.length; i++) {
            for (var j = 0; j < numFile5.length; j++) {
              if (numFile3[i] === parseInt((numFile5[j] % 10000) / 1000) * 100 +
                parseInt((numFile5[j] % 1000) / 100) * 10 +
                parseInt(numFile5[j] % 10)) {
                endNum.push(buquan(numFile5[j], 5));
              }
            }
          }
        }
        else if (document.getElementById("Contrast3").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast4").style.backgroundColor === "rgb(0, 0, 0)"
          && document.getElementById("Contrast5").style.backgroundColor === "rgb(0, 0, 0)") {
          //345
          for (let i = 0; i < numFile3.length; i++) {
            for (let j = 0; j < numFile5.length; j++) {
              if ( parseInt((numFile5[j] % 1000) / 100) * 100 +
                parseInt((numFile5[j] % 100) / 10) * 10 +
                parseInt(numFile5[j] % 10)  === numFile3[i]) {
                endNum.push(buquan(numFile5[j], 5));
              }
            }
          }
        }
        endNum.myUnique();
        endNum = endNum.join(' ')
        pailie5.textContent = endNum;
        alert(`${pathFile5.name}执行过滤成功！`)
      }
    }

    // 补全数字
    function buquan(num, length) {
      var numstr = num.toString();
      var l = numstr.length;
      if (numstr.length >= length) { return numstr; }

      for (var i = 0; i < length - l; i++) {
        numstr = "0" + numstr;
      }
      return numstr;
    }


    //数组去重 // 使用时直接调用 arr.myUnique();
    Array.prototype.myUnique = function myUnique() {
      var obj = {};
      for (var i = 0; i < this.length; i++) {
        var item = this[i];
        if (typeof obj[item] !== "undefined") {
          this[i] = this[this.length - 1];
          this.length--;
          i--;
          continue;
        }
        obj[item] = item;
      }
      obj = null;
      return this;
    }

    // 对比位数功能
    let pailieNum = 0;
    // #ddd 与 rgb(251,251,251)TMD有坑！！！
    //rgb(0, 0, 0)黑色   rgb(204, 0, 0)红色  #ddd灰色
    document.getElementById('Contrast1').onclick = function (event) {
      if (document.getElementById("Contrast1").style.backgroundColor === 'rgb(204, 0, 0)' && pailieNum <= 2) {
        pailieNum++;
        document.getElementById("Contrast1").style.backgroundColor = "rgb(0, 0, 0)";
        for (let i = 1; i <= 5; i++) {
          if (pailieNum === 3 && document.getElementById("Contrast" + i).style.backgroundColor === 'rgb(204, 0, 0)') {
            document.getElementById("Contrast" + i).style.backgroundColor = "#ddd"
          }
        }
      }
      else if (document.getElementById("Contrast1").style.backgroundColor === 'rgb(0, 0, 0)' && pailieNum <= 3) {
        pailieNum--;
        document.getElementById("Contrast1").style.backgroundColor = "rgb(204, 0, 0)";
        for (let j = 1; j <= 5; j++) {
          if (document.getElementById("Contrast" + j).style.backgroundColor !== 'rgb(204, 0, 0)' && document.getElementById("Contrast" + j).style.backgroundColor !== 'rgb(0, 0, 0)') {
            console.log('hhhh')
            document.getElementById("Contrast" + j).style.backgroundColor = "rgb(204, 0, 0)"
          }
        }
      }
    };
    document.getElementById('Contrast2').onclick = function (event) {
      if (document.getElementById("Contrast2").style.backgroundColor === 'rgb(204, 0, 0)' && pailieNum <= 2) {
        pailieNum++;
        document.getElementById("Contrast2").style.backgroundColor = "rgb(0, 0, 0)";
        for (let i = 1; i <= 5; i++) {
          if (pailieNum === 3 && document.getElementById("Contrast" + i).style.backgroundColor === 'rgb(204, 0, 0)') {
            document.getElementById("Contrast" + i).style.backgroundColor = "#ddd"
          }
        }
      }
      else if (document.getElementById("Contrast2").style.backgroundColor === 'rgb(0, 0, 0)' && pailieNum <= 3) {
        pailieNum--;
        document.getElementById("Contrast2").style.backgroundColor = "rgb(204, 0, 0)";
        for (let j = 1; j <= 5; j++) {
          if (document.getElementById("Contrast" + j).style.backgroundColor !== 'rgb(204, 0, 0)' && document.getElementById("Contrast" + j).style.backgroundColor !== 'rgb(0, 0, 0)') {
            console.log('hhhh')
            document.getElementById("Contrast" + j).style.backgroundColor = "rgb(204, 0, 0)"
          }
        }
      }
    };
    document.getElementById('Contrast3').onclick = function (event) {
      if (document.getElementById("Contrast3").style.backgroundColor === 'rgb(204, 0, 0)' && pailieNum <= 2) {
        pailieNum++;
        document.getElementById("Contrast3").style.backgroundColor = "rgb(0, 0, 0)";
        for (let i = 1; i <= 5; i++) {
          if (pailieNum === 3 && document.getElementById("Contrast" + i).style.backgroundColor === 'rgb(204, 0, 0)') {
            document.getElementById("Contrast" + i).style.backgroundColor = "#ddd"
          }
        }
      }
      else if (document.getElementById("Contrast3").style.backgroundColor === 'rgb(0, 0, 0)' && pailieNum <= 3) {
        pailieNum--;
        document.getElementById("Contrast3").style.backgroundColor = "rgb(204, 0, 0)";
        for (let j = 1; j <= 5; j++) {
          if (document.getElementById("Contrast" + j).style.backgroundColor !== 'rgb(204, 0, 0)' && document.getElementById("Contrast" + j).style.backgroundColor !== 'rgb(0, 0, 0)') {
            console.log('hhhh')
            document.getElementById("Contrast" + j).style.backgroundColor = "rgb(204, 0, 0)"
          }
        }
      }
    };
    document.getElementById('Contrast4').onclick = function (event) {
      if (document.getElementById("Contrast4").style.backgroundColor === 'rgb(204, 0, 0)' && pailieNum <= 2) {
        pailieNum++;
        document.getElementById("Contrast4").style.backgroundColor = "rgb(0, 0, 0)";
        for (let i = 1; i <= 5; i++) {
          if (pailieNum === 3 && document.getElementById("Contrast" + i).style.backgroundColor === 'rgb(204, 0, 0)') {
            document.getElementById("Contrast" + i).style.backgroundColor = "#ddd"
          }
        }
      }
      else if (document.getElementById("Contrast4").style.backgroundColor === 'rgb(0, 0, 0)' && pailieNum <= 3) {
        pailieNum--;
        document.getElementById("Contrast4").style.backgroundColor = "rgb(204, 0, 0)";
        for (let j = 1; j <= 5; j++) {
          if (document.getElementById("Contrast" + j).style.backgroundColor !== 'rgb(204, 0, 0)' && document.getElementById("Contrast" + j).style.backgroundColor !== 'rgb(0, 0, 0)') {
            console.log('hhhh')
            document.getElementById("Contrast" + j).style.backgroundColor = "rgb(204, 0, 0)"
          }
        }
      }
    };
    document.getElementById('Contrast5').onclick = function (event) {
      if (document.getElementById("Contrast5").style.backgroundColor === 'rgb(204, 0, 0)' && pailieNum <= 2) {
        pailieNum++;
        document.getElementById("Contrast5").style.backgroundColor = "rgb(0, 0, 0)";
        for (let i = 1; i <= 5; i++) {
          if (pailieNum === 3 && document.getElementById("Contrast" + i).style.backgroundColor === 'rgb(204, 0, 0)') {
            document.getElementById("Contrast" + i).style.backgroundColor = "#ddd"
          }
        }
      }
      else if (document.getElementById("Contrast5").style.backgroundColor === 'rgb(0, 0, 0)' && pailieNum <= 3) {
        pailieNum--;
        document.getElementById("Contrast5").style.backgroundColor = "rgb(204, 0, 0)";
        for (let j = 1; j <= 5; j++) {
          if (document.getElementById("Contrast" + j).style.backgroundColor !== 'rgb(204, 0, 0)' && document.getElementById("Contrast" + j).style.backgroundColor !== 'rgb(0, 0, 0)') {
            console.log('hhhh')
            document.getElementById("Contrast" + j).style.backgroundColor = "rgb(204, 0, 0)"
          }
        }
      }
    };
  </script>

</body>

</html>